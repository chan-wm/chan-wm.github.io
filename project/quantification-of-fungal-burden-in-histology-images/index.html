<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academia 4.3.1">
  <meta name="generator" content="Hugo 0.101.0" />

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Chanasak Mahankarat">

  
  
  
    
  
  <meta name="description" content="Using deep learning to quantify fungal burden in histology images">

  
  <link rel="alternate" hreflang="en-us" href="https://chan.github.io/project/quantification-of-fungal-burden-in-histology-images/">

  


  

  
  
  
  <meta name="theme-color" content="#fc6f5c">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Open+Sans|Roboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academia.min.b246554d075350d61b44c126dfbcbe05.css">

  

  
  
  
  

  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="https://chan.github.io/project/quantification-of-fungal-burden-in-histology-images/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="Chan">
  <meta property="og:url" content="https://chan.github.io/project/quantification-of-fungal-burden-in-histology-images/">
  <meta property="og:title" content="Quantification of fungal burden in histology images | Chan">
  <meta property="og:description" content="Using deep learning to quantify fungal burden in histology images"><meta property="og:image" content="https://chan.github.io/project/quantification-of-fungal-burden-in-histology-images/featured.png">
  <meta property="twitter:image" content="https://chan.github.io/project/quantification-of-fungal-burden-in-histology-images/featured.png"><meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2022-07-10T00:00:00&#43;00:00">
  
  <meta property="article:modified_time" content="2022-07-10T00:00:00&#43;00:00">
  

  


  





  <title>Quantification of fungal burden in histology images | Chan</title>

</head>


<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/">Chan</a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation"><span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">
      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#hero"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About Me</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

      

        

        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>
    </div>
  </div>
</nav>


  <article class="article article-project py-5" itemscope itemtype="http://schema.org/Article">

  













<div class="container split-header">
  <div class="row justify-content-center">
    <div class="col-lg-8">
        <img class="img-fluid w-100" src="/project/quantification-of-fungal-burden-in-histology-images/featured_hu096ca648a767305e0d23ed094bd8cfe9_1213828_680x500_fill_q90_lanczos_smart1_3.png" itemprop="image" alt="">
        <span
          class="article-header-caption">Histology image of lung tissues infected with Aspergillus fumigatus</span>
    </div>
    <div class="col-lg-8">
      <h1 itemprop="name">Quantification of fungal burden in histology images</h1>

      

      



<meta content="2022-07-10 00:00:00 &#43;0000 UTC" itemprop="datePublished">
<meta content="2022-07-10 00:00:00 &#43;0000 UTC" itemprop="dateModified">

<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    <time>Jul 10, 2022</time>
  </span>
  

  

  

  
  

  
  

  
    

  

</div>

      














    </div>
    
    </div>
  </div>
</div>

  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      <p>This project was completed, awarded First Class Honours and submitted as part of the requirements for my master of engineering degree at Imperial College London. I worked as part of the <a href="https://rtanaka.bg-research.cc.ic.ac.uk/">Biological Control Systems Lab</a> and was supervised by <a href="https://www.imperial.ac.uk/people/r.tanaka">Dr. Reiko Tanaka</a> and <a href="https://scholar.google.com/citations?hl=en&amp;user=-R7aRpQAAAAJ&amp;view_op=list_works&amp;sortby=pubdate">Dr. Rahman Attar</a>.</p>
<h1 id="aspergillus-fumigatus-and-invasive-aspergillosis">Aspergillus fumigatus and invasive aspergillosis</h1>
<p>Aspergillus fumigatus (A. fumigatus) is a ubiquitous fungus that humans are exposed to everyday. A. fumigatus reproduces asexually by releasing conidia, a type of asexual spores that
germinates into hyphae, into the atmosphere. These airborne conidia have a sufficiently small
diameter of 2-3 μm to reach the lung alveoli and humans inhale several hundred conidia per
day.</p>
<p>Inhalation of conidia can cause various illnesses depending on the immune status of the host.
In immunocompetent individuals, there is rarely any adverse effect since the conidia are efficiently
neutralised and eliminated by the immune system. However, in immunocompromised patients,
it can cause life-threatening invasive aspergillosis (IA) where the conidia germinates into hyphae
that invade the lungs and can spread rapidly to other parts of the body such as brain, heart and
kidneys which can result in death.</p>



<figure>
  <img src="img/IA.PNG"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 1: Inhalation of conidia resulting in the germination of hyphae in immunocompromised patients
</figcaption>
</figure>


<h1 id="quantification-of-fungal-burden">Quantification of fungal burden</h1>
<p>Quantifying fungal burden is important for tracking the disease progression and evaluating the effectiveness of the novel therapeutics. However, enumeration of fungal burden and extent of tissue invasion in histology images is still done manually, which is a tedious and time-consuming task and prone to error.</p>
<p>To quantify the fungal burden, we first calculate the tissue area by converting the histology image into a binary image through a thresholding technique and counting the number of black pixels which correspond to the tissue pixels. Next, the fungal area is calculated by using a convolutional neural network to segment the fungi region from the histology image and counting the number of white pixels in it as they correspond to the fungi pixels. Finally, the fungal buden is calculated by dividing the fungal area by the tissue area.</p>



<figure>
  <img src="img/fungal_burden_quantification.png"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 2: Quantification of fungal burden
</figcaption>
</figure>


<h1 id="dataset">Dataset</h1>
<p>Dataset consisted of 149 512-by-1024 pixels GMS stained patch-level histology images of murine lung infected with A. fumigatus and their corresponding pathologist-verified ground truth binary segmented masks</p>



<figure>
  <img src="img/dataset.png"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 5: The process of collecting the dataset 
</figcaption>
</figure>


<h1 id="semantic-image-segnmentation-and-convolutional-neural-network">Semantic image segnmentation and convolutional neural network</h1>
<p>Semantic image segmentation classifies every pixel of an image with a class label. In our application,
this means labelling each pixel in the histology images as fungi or non-fungi. Convolutional neural
network (CNN) is a deep learning architecture inspired by the natural visual perception mechanism. CNN learns important features in images in order to perform prediction, classification and
segmentation tasks. CNN has been widely used in multiple biomedical image analysis tasks. In histology images, CNN has been used to segment out certain tissue types such as
leukocytes, lymphocytes and erythocytes, showing great promise in quantifying the fungal burden.</p>
<p>CNN architectures for semantic segmentation usually incorporate encoder and decoder networks.
The encoder network reduces the size of an image to capture important details of the image. This
allows the model to learn important features of the image, however, it loses the spatial information.
The decoder network restores back the resolution of the image, allowing the learned features to be
localised and used to construct the segmented image.</p>
<p>In this project, we explored 4 popular segmentation network architectures FCN, U-Net, SegNet and PSPNet, and 2 different pre-trained model backbones VGG16 and ResNet50. We found that VGG U-Net model gave the highest mean DICE score when evaluated using 5-fold cross-validation.</p>



<figure>
  <img src="img/u-net-architecture.png"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 3: Architecture of U-Net (Ronneberger et al., 2015)
</figcaption>
</figure>

<figure>
  <img src="img/vgg16.png"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 4: Architecture of VGG-16 
(Simonyan & Zisserman, 2015)
</figcaption>
</figure>


<h1 id="data-augmentation">Data augmentation</h1>
<p>Deep learning techniques relies heavily on large datasets to allow the model to generalise and
avoid overfitting as the model is exposed to more training examples. However, for biomedical images
such as histology images, collecting and labelling data can be a very laborious task. Data augmentation is a technique of artificially expanding the size and variety of the dataset by applying image
transformations on the existing dataset. For this project, we used both geometric and colour transformation. For each input original image, 10 augmented images were generated, inflating the training set by 10 times.</p>
<h1 id="results">Results</h1>
<p>The VGG U-Net achieved the mean DICE score of 0.74±0.03. Figure 6 shows sample plots of the segmentation predicted as well as the predicted fungal burden quantification.</p>



<figure>
  <img src="img/results.png"  style="width:70%">
  <figcaption style='text-align:center;'>Figure 6: Sample plot of the segmentation and the fungal burden quantification
</figcaption>
</figure>


<h1 id="full-report">Full report</h1>
<p>The full report is available in the PDF format below</p>


<div style='text-align:center;'>
<embed src="files/final_report.pdf" width="70%" height="800px" 
 type="application/pdf">
</div>
 

    </div>

    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/ai-in-healthcare/">AI in Healthcare</a>
  
  <a class="badge badge-light" href="/tags/deep-learning/">Deep Learning</a>
  
  <a class="badge badge-light" href="/tags/computer-vision/">Computer Vision</a>
  
  <a class="badge badge-light" href="/tags/image-segmentation/">Image Segmentation</a>
  
</div>


    








  





  
  
  
    
  
  
  <div class="media author-card" itemscope itemtype="http://schema.org/Person">
    

    <div class="media-body">
      <h5 class="card-title" itemprop="name"><a href="https://chan.github.io">Chanasak Mahankarat</a></h5>
      <h6 class="card-subtitle">Software Engineer</h6>
      
      <ul class="network-icon" aria-hidden="true">
        
          
          
          
            
          
          
          
          
          
          <li>
            <a itemprop="sameAs" href="mailto:chan-wm@outlook.com" >
              <i class="fas fa-envelope"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://github.com/chan-wm" target="_blank" rel="noopener">
              <i class="fab fa-github"></i>
            </a>
          </li>
        
          
          
          
            
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="https://www.linkedin.com/in/winn-chanasak/" target="_blank" rel="noopener">
              <i class="fab fa-linkedin"></i>
            </a>
          </li>
        
          
          
          
          
          
          
          
            
          
          <li>
            <a itemprop="sameAs" href="/files/cv.pdf" >
              <i class="ai ai-cv"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>




    
    

    
    
    

    
    
    
    </div>

    
    
    
    </div>
  </div>
</article>



      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
      

      
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
    
    
    <script src="/js/academia.min.dfdbec5c302869d273abc0cf38cd8f0d.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-md-6 mb-4 mb-md-0">
        
        <p class="mb-0">
          Copyright © 2022 &middot; 
          Powered by
          <a href="https://gethugothemes.com" target="_blank" rel="noopener">Gethugothemes</a>
        </p>
      </div>
      <div class="col-md-6">
        <ul class="list-inline network-icon text-right mb-0">
          
          
        </ul>
      </div>
    </div>
  </div>
</footer>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
